{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"hw12_reinforcement_learning_chinese_version.ipynb","provenance":[],"collapsed_sections":[],"toc_visible":true},"kernelspec":{"display_name":"Python 3","name":"python3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"05b1ee56970c410896877760b52c9214":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_8a3106d9a60142469f51c882ab6a089e","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c1166743355440d2a355132a2fea512c","IPY_MODEL_af1ee460ae414c2c8bc9132437e5c80e"]}},"8a3106d9a60142469f51c882ab6a089e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c1166743355440d2a355132a2fea512c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_497d775c41744cfaa78f9485ffe563f6","_dom_classes":[],"description":"Total:  275.3, Final:  100.0: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":2000,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":2000,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7c1338fd15274941a7d70c44c7c89d5f"}},"af1ee460ae414c2c8bc9132437e5c80e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ef822bf70c7e4f5992cb7e52985ca584","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 2000/2000 [4:38:34&lt;00:00,  8.36s/it]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_686c6cc13ece4aa3bd878184661dcb34"}},"497d775c41744cfaa78f9485ffe563f6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"7c1338fd15274941a7d70c44c7c89d5f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ef822bf70c7e4f5992cb7e52985ca584":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"686c6cc13ece4aa3bd878184661dcb34":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0_1LX6N49Tim","executionInfo":{"status":"ok","timestamp":1622943805057,"user_tz":-480,"elapsed":3413,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"52151c31-2bc9-46f1-f4bb-c95f9cfe638e"},"source":["import torch\n","try:\n","    # Get GPU name, check if it's K80\n","    GPU_name = torch.cuda.get_device_name()\n","    if GPU_name[-3:] == \"K80\":\n","        print(\"Get K80! :'( RESTART!\")\n","        exit()  # Restart the session\n","    else:\n","        print(\"Your GPU is {}!\".format(GPU_name))\n","        print(\"Great! Keep going~\")\n","except RuntimeError as e:\n","    if e.args == (\"No CUDA GPUs are available\",):\n","        print(\"You are training with CPU! \"\n","              \"Please restart!\")\n","        exit()  # Restart the session\n","    else:\n","        print(\"What's wrong here?\")\n","        print(\"Error message: \\n\", e)"],"execution_count":1,"outputs":[{"output_type":"stream","text":["Your GPU is Tesla T4!\n","Great! Keep going~\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Enz9FVHn9hcx","executionInfo":{"status":"ok","timestamp":1622943821997,"user_tz":-480,"elapsed":15899,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"daf5b386-9b5d-459d-c29f-39296001b2ff"},"source":["from google.colab import drive\n","drive.mount('/content/gdrive')\n","import os\n","\n","# your workspace in your drive\n","workspace = 'Course_ML2021Spring/HW12'\n","\n","\n","try:\n","  os.chdir(os.path.join('/content/gdrive/My Drive/', workspace))\n","except:\n","  os.mkdir(os.path.join('/content/gdrive/My Drive/', workspace))\n","  os.chdir(os.path.join('/content/gdrive/My Drive/', workspace))"],"execution_count":2,"outputs":[{"output_type":"stream","text":["Mounted at /content/gdrive\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"Fp30SB4bxeQb"},"source":["# **Homework 12 - Reinforcement Learning**\n","\n","若有任何問題，歡迎來信至助教信箱 ntu-ml-2021spring-ta@googlegroups.com\n","\n"]},{"cell_type":"markdown","metadata":{"id":"yXsnCWPtWSNk"},"source":["## 前置作業\n","\n","首先我們需要安裝必要的系統套件及 PyPi 套件。\n","gym 這個套件由 OpenAI 所提供，是一套用來開發與比較 Reinforcement Learning 演算法的工具包（toolkit）。\n","而其餘套件則是為了在 Notebook 中繪圖所需要的套件。"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"5e2bScpnkVbv","executionInfo":{"status":"ok","timestamp":1622943852705,"user_tz":-480,"elapsed":16639,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"6b8a256a-ba48-45b9-d78e-4eb4963febef"},"source":["!apt update\n","!apt install python-opengl xvfb -y\n","!pip install gym[box2d]==0.18.3 pyvirtualdisplay tqdm numpy==1.19.5 torch==1.8.1"],"execution_count":3,"outputs":[{"output_type":"stream","text":["\u001b[33m\r0% [Working]\u001b[0m\r            \rGet:1 http://security.ubuntu.com/ubuntu bionic-security InRelease [88.7 kB]\n","\u001b[33m\r0% [Connecting to archive.ubuntu.com (91.189.88.152)] [1 InRelease 14.2 kB/88.7\u001b[0m\r                                                                               \rGet:2 https://cloud.r-project.org/bin/linux/ubuntu bionic-cran40/ InRelease [3,626 B]\n","\u001b[33m\r0% [Connecting to archive.ubuntu.com (91.189.88.152)] [1 InRelease 43.1 kB/88.7\u001b[0m\u001b[33m\r0% [Connecting to archive.ubuntu.com (91.189.88.152)] [1 InRelease 75.0 kB/88.7\u001b[0m\u001b[33m\r0% [2 InRelease gpgv 3,626 B] [Connecting to archive.ubuntu.com (91.189.88.152)\u001b[0m\u001b[33m\r0% [2 InRelease gpgv 3,626 B] [Connecting to archive.ubuntu.com (91.189.88.152)\u001b[0m\r                                                                               \rIgn:3 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64  InRelease\n","Hit:4 http://archive.ubuntu.com/ubuntu bionic InRelease\n","Get:5 http://ppa.launchpad.net/c2d4u.team/c2d4u4.0+/ubuntu bionic InRelease [15.9 kB]\n","Ign:6 https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1804/x86_64  InRelease\n","Hit:7 https://developer.download.nvidia.com/compute/cuda/repos/ubuntu1804/x86_64  Release\n","Hit:8 https://developer.download.nvidia.com/compute/machine-learning/repos/ubuntu1804/x86_64  Release\n","Get:9 http://archive.ubuntu.com/ubuntu bionic-updates InRelease [88.7 kB]\n","Hit:10 http://ppa.launchpad.net/cran/libgit2/ubuntu bionic InRelease\n","Get:11 http://security.ubuntu.com/ubuntu bionic-security/main amd64 Packages [2,184 kB]\n","Get:12 http://archive.ubuntu.com/ubuntu bionic-backports InRelease [74.6 kB]\n","Get:13 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu bionic InRelease [15.9 kB]\n","Get:14 http://security.ubuntu.com/ubuntu bionic-security/universe amd64 Packages [1,414 kB]\n","Get:15 http://security.ubuntu.com/ubuntu bionic-security/restricted amd64 Packages [450 kB]\n","Hit:16 http://ppa.launchpad.net/graphics-drivers/ppa/ubuntu bionic InRelease\n","Get:19 http://ppa.launchpad.net/c2d4u.team/c2d4u4.0+/ubuntu bionic/main Sources [1,770 kB]\n","Get:20 http://archive.ubuntu.com/ubuntu bionic-updates/main amd64 Packages [2,616 kB]\n","Get:21 http://archive.ubuntu.com/ubuntu bionic-updates/restricted amd64 Packages [480 kB]\n","Get:22 http://archive.ubuntu.com/ubuntu bionic-updates/multiverse amd64 Packages [33.5 kB]\n","Get:23 http://ppa.launchpad.net/c2d4u.team/c2d4u4.0+/ubuntu bionic/main amd64 Packages [906 kB]\n","Get:24 http://archive.ubuntu.com/ubuntu bionic-updates/universe amd64 Packages [2,184 kB]\n","Get:25 http://ppa.launchpad.net/deadsnakes/ppa/ubuntu bionic/main amd64 Packages [40.9 kB]\n","Fetched 12.4 MB in 3s (4,376 kB/s)\n","Reading package lists... Done\n","Building dependency tree       \n","Reading state information... Done\n","46 packages can be upgraded. Run 'apt list --upgradable' to see them.\n","Reading package lists... Done\n","Building dependency tree       \n","Reading state information... Done\n","Suggested packages:\n","  libgle3\n","The following NEW packages will be installed:\n","  python-opengl xvfb\n","0 upgraded, 2 newly installed, 0 to remove and 46 not upgraded.\n","Need to get 1,281 kB of archives.\n","After this operation, 7,686 kB of additional disk space will be used.\n","Get:1 http://archive.ubuntu.com/ubuntu bionic/universe amd64 python-opengl all 3.1.0+dfsg-1 [496 kB]\n","Get:2 http://archive.ubuntu.com/ubuntu bionic-updates/universe amd64 xvfb amd64 2:1.19.6-1ubuntu4.9 [784 kB]\n","Fetched 1,281 kB in 1s (1,704 kB/s)\n","Selecting previously unselected package python-opengl.\n","(Reading database ... 160772 files and directories currently installed.)\n","Preparing to unpack .../python-opengl_3.1.0+dfsg-1_all.deb ...\n","Unpacking python-opengl (3.1.0+dfsg-1) ...\n","Selecting previously unselected package xvfb.\n","Preparing to unpack .../xvfb_2%3a1.19.6-1ubuntu4.9_amd64.deb ...\n","Unpacking xvfb (2:1.19.6-1ubuntu4.9) ...\n","Setting up python-opengl (3.1.0+dfsg-1) ...\n","Setting up xvfb (2:1.19.6-1ubuntu4.9) ...\n","Processing triggers for man-db (2.8.3-2ubuntu0.1) ...\n","Collecting gym[box2d]==0.18.3\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/1a/db/816fd52c0c196b6799e89d1f65b6c74fead2707cf7d447f3f354edfa7a44/gym-0.18.3.tar.gz (1.6MB)\n","\u001b[K     |████████████████████████████████| 1.6MB 31.1MB/s \n","\u001b[?25hCollecting pyvirtualdisplay\n","  Downloading https://files.pythonhosted.org/packages/79/30/e99e0c480a858410757e7516958e149285ea08ed6c9cfe201ed0aa12cee2/PyVirtualDisplay-2.2-py3-none-any.whl\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.7/dist-packages (4.41.1)\n","Requirement already satisfied: numpy==1.19.5 in /usr/local/lib/python3.7/dist-packages (1.19.5)\n","Requirement already satisfied: torch==1.8.1 in /usr/local/lib/python3.7/dist-packages (1.8.1+cu101)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from gym[box2d]==0.18.3) (1.4.1)\n","Requirement already satisfied: pyglet<=1.5.15,>=1.4.0 in /usr/local/lib/python3.7/dist-packages (from gym[box2d]==0.18.3) (1.5.0)\n","Requirement already satisfied: Pillow<=8.2.0 in /usr/local/lib/python3.7/dist-packages (from gym[box2d]==0.18.3) (7.1.2)\n","Requirement already satisfied: cloudpickle<1.7.0,>=1.2.0 in /usr/local/lib/python3.7/dist-packages (from gym[box2d]==0.18.3) (1.3.0)\n","Collecting box2d-py~=2.3.5\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/87/34/da5393985c3ff9a76351df6127c275dcb5749ae0abbe8d5210f06d97405d/box2d_py-2.3.8-cp37-cp37m-manylinux1_x86_64.whl (448kB)\n","\u001b[K     |████████████████████████████████| 450kB 45.4MB/s \n","\u001b[?25hCollecting EasyProcess\n","  Downloading https://files.pythonhosted.org/packages/48/3c/75573613641c90c6d094059ac28adb748560d99bd27ee6f80cce398f404e/EasyProcess-0.3-py2.py3-none-any.whl\n","Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch==1.8.1) (3.7.4.3)\n","Requirement already satisfied: future in /usr/local/lib/python3.7/dist-packages (from pyglet<=1.5.15,>=1.4.0->gym[box2d]==0.18.3) (0.16.0)\n","Building wheels for collected packages: gym\n","  Building wheel for gym (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for gym: filename=gym-0.18.3-cp37-none-any.whl size=1657528 sha256=6c116433d70fb0cef106be7077344d3def170b27f39c0246787ad9f37d316318\n","  Stored in directory: /root/.cache/pip/wheels/93/c2/4c/2b4c9b85119994837c08315c9415d71008325b7004d385b418\n","Successfully built gym\n","Installing collected packages: box2d-py, gym, EasyProcess, pyvirtualdisplay\n","  Found existing installation: gym 0.17.3\n","    Uninstalling gym-0.17.3:\n","      Successfully uninstalled gym-0.17.3\n","Successfully installed EasyProcess-0.3 box2d-py-2.3.8 gym-0.18.3 pyvirtualdisplay-2.2\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"M_-i3cdoYsks"},"source":["接下來，設置好 virtual display，並引入所有必要的套件。"]},{"cell_type":"code","metadata":{"id":"nl2nREINDLiw","executionInfo":{"status":"ok","timestamp":1622943853979,"user_tz":-480,"elapsed":1277,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}}},"source":["%%capture\n","from pyvirtualdisplay import Display\n","virtual_display = Display(visible=0, size=(1400, 900))\n","virtual_display.start()\n","\n","%matplotlib inline\n","import matplotlib.pyplot as plt\n","\n","from IPython import display\n","\n","import numpy as np\n","import torch\n","import torch.nn as nn\n","import torch.optim as optim\n","import torch.nn.functional as F\n","from torch.distributions import Categorical\n","from tqdm.notebook import tqdm"],"execution_count":4,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"HVu9-Vdrl4E3"},"source":["# 請不要更改 random seed !!!!\n","# 不然在judgeboi上 你的成績不會被reproduce !!!!"]},{"cell_type":"code","metadata":{"id":"fV9i8i2YkRbO","executionInfo":{"status":"ok","timestamp":1622943853979,"user_tz":-480,"elapsed":3,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}}},"source":["seed = 543 # Do not change this\n","def fix(env, seed):\n","  env.seed(seed)\n","  env.action_space.seed(seed)\n","  torch.manual_seed(seed)\n","  torch.cuda.manual_seed(seed)\n","  torch.cuda.manual_seed_all(seed)\n","  np.random.seed(seed)\n","  random.seed(seed)\n","  torch.set_deterministic(True)\n","  torch.backends.cudnn.benchmark = False\n","  torch.backends.cudnn.deterministic = True"],"execution_count":5,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"He0XDx6bzjgC"},"source":["最後，引入 OpenAI 的 gym，並建立一個 [Lunar Lander](https://gym.openai.com/envs/LunarLander-v2/) 環境。"]},{"cell_type":"code","metadata":{"id":"N_4-xJcbBt09","executionInfo":{"status":"ok","timestamp":1622943854532,"user_tz":-480,"elapsed":555,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}}},"source":["%%capture\n","import gym\n","import random\n","import numpy as np\n","\n","env = gym.make('LunarLander-v2')\n","\n","fix(env, seed)"],"execution_count":6,"outputs":[]},{"cell_type":"code","metadata":{"id":"NmiAOfqRwRX5","executionInfo":{"status":"ok","timestamp":1622943854532,"user_tz":-480,"elapsed":3,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}}},"source":["import time\n","start = time.time()"],"execution_count":7,"outputs":[]},{"cell_type":"code","metadata":{"id":"LcMjEUWTBEEB","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1622943855238,"user_tz":-480,"elapsed":708,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"1a12cf3a-69d9-4b0b-e984-395a01920f6b"},"source":["!pip freeze"],"execution_count":8,"outputs":[{"output_type":"stream","text":["absl-py==0.12.0\n","alabaster==0.7.12\n","albumentations==0.1.12\n","altair==4.1.0\n","appdirs==1.4.4\n","argon2-cffi==20.1.0\n","arviz==0.11.2\n","astor==0.8.1\n","astropy==4.2.1\n","astunparse==1.6.3\n","async-generator==1.10\n","atari-py==0.2.9\n","atomicwrites==1.4.0\n","attrs==21.2.0\n","audioread==2.1.9\n","autograd==1.3\n","Babel==2.9.1\n","backcall==0.2.0\n","beautifulsoup4==4.6.3\n","bleach==3.3.0\n","blis==0.4.1\n","bokeh==2.3.2\n","Bottleneck==1.3.2\n","box2d-py==2.3.8\n","branca==0.4.2\n","bs4==0.0.1\n","CacheControl==0.12.6\n","cached-property==1.5.2\n","cachetools==4.2.2\n","catalogue==1.0.0\n","certifi==2020.12.5\n","cffi==1.14.5\n","cftime==1.5.0\n","chainer==7.4.0\n","chardet==3.0.4\n","click==7.1.2\n","cloudpickle==1.3.0\n","cmake==3.12.0\n","cmdstanpy==0.9.5\n","colorcet==2.0.6\n","colorlover==0.3.0\n","community==1.0.0b1\n","contextlib2==0.5.5\n","convertdate==2.3.2\n","coverage==3.7.1\n","coveralls==0.5\n","crcmod==1.7\n","cufflinks==0.17.3\n","cupy-cuda101==7.4.0\n","cvxopt==1.2.6\n","cvxpy==1.0.31\n","cycler==0.10.0\n","cymem==2.0.5\n","Cython==0.29.23\n","daft==0.0.4\n","dask==2.12.0\n","datascience==0.10.6\n","debugpy==1.0.0\n","decorator==4.4.2\n","defusedxml==0.7.1\n","descartes==1.1.0\n","dill==0.3.3\n","distributed==1.25.3\n","dlib==19.18.0\n","dm-tree==0.1.6\n","docopt==0.6.2\n","docutils==0.17.1\n","dopamine-rl==1.0.5\n","earthengine-api==0.1.266\n","easydict==1.9\n","EasyProcess==0.3\n","ecos==2.0.7.post1\n","editdistance==0.5.3\n","en-core-web-sm==2.2.5\n","entrypoints==0.3\n","ephem==3.7.7.1\n","et-xmlfile==1.1.0\n","fa2==0.3.5\n","fastai==1.0.61\n","fastdtw==0.3.4\n","fastprogress==1.0.0\n","fastrlock==0.6\n","fbprophet==0.7.1\n","feather-format==0.4.1\n","filelock==3.0.12\n","firebase-admin==4.4.0\n","fix-yahoo-finance==0.0.22\n","Flask==1.1.4\n","flatbuffers==1.12\n","folium==0.8.3\n","future==0.16.0\n","gast==0.4.0\n","GDAL==2.2.2\n","gdown==3.6.4\n","gensim==3.6.0\n","geographiclib==1.50\n","geopy==1.17.0\n","gin-config==0.4.0\n","glob2==0.7\n","google==2.0.3\n","google-api-core==1.26.3\n","google-api-python-client==1.12.8\n","google-auth==1.30.0\n","google-auth-httplib2==0.0.4\n","google-auth-oauthlib==0.4.4\n","google-cloud-bigquery==1.21.0\n","google-cloud-bigquery-storage==1.1.0\n","google-cloud-core==1.0.3\n","google-cloud-datastore==1.8.0\n","google-cloud-firestore==1.7.0\n","google-cloud-language==1.2.0\n","google-cloud-storage==1.18.1\n","google-cloud-translate==1.5.0\n","google-colab==1.0.0\n","google-pasta==0.2.0\n","google-resumable-media==0.4.1\n","googleapis-common-protos==1.53.0\n","googledrivedownloader==0.4\n","graphviz==0.10.1\n","greenlet==1.1.0\n","grpcio==1.34.1\n","gspread==3.0.1\n","gspread-dataframe==3.0.8\n","gym==0.18.3\n","h5py==3.1.0\n","HeapDict==1.0.1\n","hijri-converter==2.1.1\n","holidays==0.10.5.2\n","holoviews==1.14.3\n","html5lib==1.0.1\n","httpimport==0.5.18\n","httplib2==0.17.4\n","httplib2shim==0.0.3\n","humanize==0.5.1\n","hyperopt==0.1.2\n","ideep4py==2.0.0.post3\n","idna==2.10\n","imageio==2.4.1\n","imagesize==1.2.0\n","imbalanced-learn==0.4.3\n","imblearn==0.0\n","imgaug==0.2.9\n","importlib-metadata==4.0.1\n","importlib-resources==5.1.3\n","imutils==0.5.4\n","inflect==2.1.0\n","iniconfig==1.1.1\n","install==1.3.4\n","intel-openmp==2021.2.0\n","intervaltree==2.1.0\n","ipykernel==4.10.1\n","ipython==5.5.0\n","ipython-genutils==0.2.0\n","ipython-sql==0.3.9\n","ipywidgets==7.6.3\n","itsdangerous==1.1.0\n","jax==0.2.13\n","jaxlib==0.1.66+cuda110\n","jdcal==1.4.1\n","jedi==0.18.0\n","jieba==0.42.1\n","Jinja2==2.11.3\n","joblib==1.0.1\n","jpeg4py==0.1.4\n","jsonschema==2.6.0\n","jupyter==1.0.0\n","jupyter-client==5.3.5\n","jupyter-console==5.2.0\n","jupyter-core==4.7.1\n","jupyterlab-pygments==0.1.2\n","jupyterlab-widgets==1.0.0\n","kaggle==1.5.12\n","kapre==0.3.5\n","Keras==2.4.3\n","keras-nightly==2.5.0.dev2021032900\n","Keras-Preprocessing==1.1.2\n","keras-vis==0.4.1\n","kiwisolver==1.3.1\n","korean-lunar-calendar==0.2.1\n","librosa==0.8.0\n","lightgbm==2.2.3\n","llvmlite==0.34.0\n","lmdb==0.99\n","LunarCalendar==0.0.9\n","lxml==4.2.6\n","Markdown==3.3.4\n","MarkupSafe==2.0.1\n","matplotlib==3.2.2\n","matplotlib-inline==0.1.2\n","matplotlib-venn==0.11.6\n","missingno==0.4.2\n","mistune==0.8.4\n","mizani==0.6.0\n","mkl==2019.0\n","mlxtend==0.14.0\n","more-itertools==8.7.0\n","moviepy==0.2.3.5\n","mpmath==1.2.1\n","msgpack==1.0.2\n","multiprocess==0.70.11.1\n","multitasking==0.0.9\n","murmurhash==1.0.5\n","music21==5.5.0\n","natsort==5.5.0\n","nbclient==0.5.3\n","nbconvert==5.6.1\n","nbformat==5.1.3\n","nest-asyncio==1.5.1\n","netCDF4==1.5.6\n","networkx==2.5.1\n","nibabel==3.0.2\n","nltk==3.2.5\n","notebook==5.3.1\n","numba==0.51.2\n","numexpr==2.7.3\n","numpy==1.19.5\n","nvidia-ml-py3==7.352.0\n","oauth2client==4.1.3\n","oauthlib==3.1.0\n","okgrade==0.4.3\n","opencv-contrib-python==4.1.2.30\n","opencv-python==4.1.2.30\n","openpyxl==2.5.9\n","opt-einsum==3.3.0\n","osqp==0.6.2.post0\n","packaging==20.9\n","palettable==3.3.0\n","pandas==1.1.5\n","pandas-datareader==0.9.0\n","pandas-gbq==0.13.3\n","pandas-profiling==1.4.1\n","pandocfilters==1.4.3\n","panel==0.11.3\n","param==1.10.1\n","parso==0.8.2\n","pathlib==1.0.1\n","patsy==0.5.1\n","pexpect==4.8.0\n","pickleshare==0.7.5\n","Pillow==7.1.2\n","pip-tools==4.5.1\n","plac==1.1.3\n","plotly==4.4.1\n","plotnine==0.6.0\n","pluggy==0.7.1\n","pooch==1.3.0\n","portpicker==1.3.9\n","prefetch-generator==1.0.1\n","preshed==3.0.5\n","prettytable==2.1.0\n","progressbar2==3.38.0\n","prometheus-client==0.10.1\n","promise==2.3\n","prompt-toolkit==1.0.18\n","protobuf==3.12.4\n","psutil==5.4.8\n","psycopg2==2.7.6.1\n","ptyprocess==0.7.0\n","py==1.10.0\n","pyarrow==3.0.0\n","pyasn1==0.4.8\n","pyasn1-modules==0.2.8\n","pycocotools==2.0.2\n","pycparser==2.20\n","pyct==0.4.8\n","pydata-google-auth==1.2.0\n","pydot==1.3.0\n","pydot-ng==2.0.0\n","pydotplus==2.0.2\n","PyDrive==1.3.1\n","pyemd==0.5.1\n","pyerfa==2.0.0\n","pyglet==1.5.0\n","Pygments==2.6.1\n","pygobject==3.26.1\n","pymc3==3.11.2\n","PyMeeus==0.5.11\n","pymongo==3.11.4\n","pymystem3==0.2.0\n","PyOpenGL==3.1.5\n","pyparsing==2.4.7\n","pyrsistent==0.17.3\n","pysndfile==1.3.8\n","PySocks==1.7.1\n","pystan==2.19.1.1\n","pytest==3.6.4\n","python-apt==0.0.0\n","python-chess==0.23.11\n","python-dateutil==2.8.1\n","python-louvain==0.15\n","python-slugify==5.0.2\n","python-utils==2.5.6\n","pytz==2018.9\n","PyVirtualDisplay==2.2\n","pyviz-comms==2.0.1\n","PyWavelets==1.1.1\n","PyYAML==3.13\n","pyzmq==22.0.3\n","qdldl==0.1.5.post0\n","qtconsole==5.1.0\n","QtPy==1.9.0\n","regex==2019.12.20\n","requests==2.23.0\n","requests-oauthlib==1.3.0\n","resampy==0.2.2\n","retrying==1.3.3\n","rpy2==3.4.4\n","rsa==4.7.2\n","scikit-image==0.16.2\n","scikit-learn==0.22.2.post1\n","scipy==1.4.1\n","screen-resolution-extra==0.0.0\n","scs==2.1.3\n","seaborn==0.11.1\n","semver==2.13.0\n","Send2Trash==1.5.0\n","setuptools-git==1.2\n","Shapely==1.7.1\n","simplegeneric==0.8.1\n","six==1.15.0\n","sklearn==0.0\n","sklearn-pandas==1.8.0\n","smart-open==5.0.0\n","snowballstemmer==2.1.0\n","sortedcontainers==2.4.0\n","SoundFile==0.10.3.post1\n","spacy==2.2.4\n","Sphinx==1.8.5\n","sphinxcontrib-serializinghtml==1.1.4\n","sphinxcontrib-websupport==1.2.4\n","SQLAlchemy==1.4.15\n","sqlparse==0.4.1\n","srsly==1.0.5\n","statsmodels==0.10.2\n","sympy==1.7.1\n","tables==3.4.4\n","tabulate==0.8.9\n","tblib==1.7.0\n","tensorboard==2.5.0\n","tensorboard-data-server==0.6.1\n","tensorboard-plugin-wit==1.8.0\n","tensorflow==2.5.0\n","tensorflow-datasets==4.0.1\n","tensorflow-estimator==2.5.0\n","tensorflow-gcs-config==2.5.0\n","tensorflow-hub==0.12.0\n","tensorflow-metadata==1.0.0\n","tensorflow-probability==0.12.1\n","termcolor==1.1.0\n","terminado==0.10.0\n","testpath==0.5.0\n","text-unidecode==1.3\n","textblob==0.15.3\n","Theano-PyMC==1.1.2\n","thinc==7.4.0\n","tifffile==2021.4.8\n","toml==0.10.2\n","toolz==0.11.1\n","torch==1.8.1+cu101\n","torchsummary==1.5.1\n","torchtext==0.9.1\n","torchvision==0.9.1+cu101\n","tornado==5.1.1\n","tqdm==4.41.1\n","traitlets==5.0.5\n","tweepy==3.10.0\n","typeguard==2.7.1\n","typing-extensions==3.7.4.3\n","tzlocal==1.5.1\n","uritemplate==3.0.1\n","urllib3==1.24.3\n","vega-datasets==0.9.0\n","wasabi==0.8.2\n","wcwidth==0.2.5\n","webencodings==0.5.1\n","Werkzeug==1.0.1\n","widgetsnbextension==3.5.1\n","wordcloud==1.5.0\n","wrapt==1.12.1\n","xarray==0.18.2\n","xgboost==0.90\n","xkit==0.0.0\n","xlrd==1.1.0\n","xlwt==1.3.0\n","yellowbrick==0.9.1\n","zict==2.0.0\n","zipp==3.4.1\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"NrkVvTrvWZ5H"},"source":["## 什麼是 Lunar Lander？\n","\n","“LunarLander-v2” 這個環境是在模擬登月小艇降落在月球表面時的情形。\n","這個任務的目標是讓登月小艇「安全地」降落在兩個黃色旗幟間的平地上。\n","> Landing pad is always at coordinates (0,0).\n","> Coordinates are the first two numbers in state vector.\n","\n","![](https://gym.openai.com/assets/docs/aeloop-138c89d44114492fd02822303e6b4b07213010bb14ca5856d2d49d6b62d88e53.svg)\n","\n","所謂的「環境」其實同時包括了 agent 和 environment。\n","我們利用 `step()` 這個函式讓 agent 行動，而後函式便會回傳 environment 給予的 observation/state（以下這兩個名詞代表同樣的意思）和 reward。"]},{"cell_type":"markdown","metadata":{"id":"bIbp82sljvAt"},"source":["### Observation / State\n","\n","首先，我們可以看看 environment 回傳給 agent 的 observation 究竟是長什麼樣子的資料："]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"rsXZra3N9R5T","executionInfo":{"status":"ok","timestamp":1622943855239,"user_tz":-480,"elapsed":19,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"fdabc5f3-10da-47aa-cd99-41e7ee300f21"},"source":["print(env.observation_space)"],"execution_count":9,"outputs":[{"output_type":"stream","text":["Box(-inf, inf, (8,), float32)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"ezdfoThbAQ49"},"source":["`Box(8,)` 說明我們會拿到 8 維的向量作為 observation，其中包含：垂直及水平座標、速度、角度、加速度等等，這部分我們就不細說。\n","\n","### Action\n","\n","而在 agent 得到 observation 和 reward 以後，能夠採取的動作有："]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"p1k4dIrBAaKi","executionInfo":{"status":"ok","timestamp":1622943855239,"user_tz":-480,"elapsed":14,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"01c3a40d-b920-4246-c05a-1d0ffcc5719c"},"source":["print(env.action_space)"],"execution_count":10,"outputs":[{"output_type":"stream","text":["Discrete(4)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"dejXT6PHBrPn"},"source":["`Discrete(4)` 說明 agent 可以採取四種離散的行動：\n","- 0 代表不採取任何行動\n","- 2 代表主引擎向下噴射\n","- 1, 3 則是向左右噴射\n","\n","接下來，我們嘗試讓 agent 與 environment 互動。\n","在進行任何操作前，建議先呼叫 `reset()` 函式讓整個「環境」重置。\n","而這個函式同時會回傳「環境」最初始的狀態。"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pi4OmrmZgnWA","executionInfo":{"status":"ok","timestamp":1622943855239,"user_tz":-480,"elapsed":13,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"4b98fcae-773c-4200-f826-7b30eb8c6952"},"source":["initial_state = env.reset()\n","print(initial_state)"],"execution_count":11,"outputs":[{"output_type":"stream","text":["[ 0.00396109  1.4083536   0.40119505 -0.11407257 -0.00458307 -0.09087662\n","  0.          0.        ]\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"uBx0mEqqgxJ9"},"source":["接著，我們試著從 agent 的四種行動空間中，隨機採取一個行動"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vxkOEXRKgizt","executionInfo":{"status":"ok","timestamp":1622943855241,"user_tz":-480,"elapsed":13,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"65be7637-5a02-42b0-e726-518d0a5cd0b9"},"source":["random_action = env.action_space.sample()\n","print(random_action)"],"execution_count":12,"outputs":[{"output_type":"stream","text":["0\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"mns-bO01g0-J"},"source":["再利用 `step()` 函式讓 agent 根據我們隨機抽樣出來的 `random_action` 動作。\n","而這個函式會回傳四項資訊：\n","- observation / state\n","- reward\n","- 完成與否\n","- 其餘資訊"]},{"cell_type":"code","metadata":{"id":"E_WViSxGgIk9","executionInfo":{"status":"ok","timestamp":1622943855241,"user_tz":-480,"elapsed":10,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}}},"source":["observation, reward, done, info = env.step(random_action)"],"execution_count":13,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"FdieGq7NuBIm"},"source":["第一項資訊 `observation` 即為 agent 採取行動之後，agent 對於環境的 observation 或者說環境的 state 為何。\n","而第三項資訊 `done` 則是 `True` 或 `False` 的布林值，當登月小艇成功著陸或是不幸墜毀時，代表這個回合（episode）也就跟著結束了，此時 `step()` 函式便會回傳 `done = True`，而在那之前，`done` 則保持 `False`。"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yK7r126kuCNp","executionInfo":{"status":"ok","timestamp":1622943855242,"user_tz":-480,"elapsed":10,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"a186cddf-1f4e-4733-cbb6-53b239d45590"},"source":["print(done)"],"execution_count":14,"outputs":[{"output_type":"stream","text":["False\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"GKdS8vOihxhc"},"source":["### Reward\n","\n","而「環境」給予的 reward 大致是這樣計算：\n","- 小艇墜毀得到 -100 分\n","- 小艇在黃旗幟之間成功著地則得 100~140 分\n","- 噴射主引擎（向下噴火）每次 -0.3 分\n","- 小艇最終完全靜止則再得 100 分\n","- 小艇每隻腳碰觸地面 +10 分\n","\n","> Reward for moving from the top of the screen to landing pad and zero speed is about 100..140 points.\n","> If lander moves away from landing pad it loses reward back.\n","> Episode finishes if the lander crashes or comes to rest, receiving additional -100 or +100 points.\n","> Each leg ground contact is +10.\n","> Firing main engine is -0.3 points each frame.\n"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vxQNs77hi0_7","executionInfo":{"status":"ok","timestamp":1622943855243,"user_tz":-480,"elapsed":9,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"20b13ff3-4ba4-4bc7-f2af-9a6446531adb"},"source":["print(reward) # after doing a random action (0), the immediate reward is stored in this "],"execution_count":15,"outputs":[{"output_type":"stream","text":["-0.8588900517154912\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"Mhqp6D-XgHpe"},"source":["### Random Agent\n","\n","最後，在進入實做之前，我們就來看看這樣一個 random agent 能否成功登陸月球："]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":269},"id":"Y3G0bxoccelv","executionInfo":{"status":"ok","timestamp":1622943865990,"user_tz":-480,"elapsed":10755,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"57c0b8c3-7e45-4c3f-cb06-f58d48e713b5"},"source":["\n","env.reset()\n","\n","img = plt.imshow(env.render(mode='rgb_array'))\n","\n","done = False\n","while not done:\n","    action = env.action_space.sample()\n","    observation, reward, done, _ = env.step(action)\n","\n","    img.set_data(env.render(mode='rgb_array'))\n","    display.display(plt.gcf())\n","    display.clear_output(wait=True)"],"execution_count":16,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[],"needs_background":"light"}}]},{"cell_type":"markdown","metadata":{"id":"F5paWqo7tWL2"},"source":["## Policy Gradient\n","\n","現在來搭建一個簡單的 policy network。\n","我們預設模型的輸入是 8-dim 的 observation，輸出則是離散的四個動作之一："]},{"cell_type":"code","metadata":{"id":"J8tdmeD-tZew","executionInfo":{"status":"ok","timestamp":1622943865991,"user_tz":-480,"elapsed":9,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}}},"source":["class PolicyGradientNetwork(nn.Module):\n","\n","    def __init__(self):\n","        super().__init__()\n","        self.fc1 = nn.Linear(8, 16)\n","        self.fc2 = nn.Linear(16, 16)\n","        self.fc3 = nn.Linear(16, 4)\n","\n","        # self.fc1 = nn.Linear(8, 16)\n","        # self.fc2 = nn.Linear(16, 32)\n","        # self.fc3 = nn.Linear(32, 16)\n","        # self.fc4 = nn.Linear(16, 4)\n","\n","\n","    def forward(self, state):\n","        hid = torch.tanh(self.fc1(state))\n","        hid = torch.tanh(self.fc2(hid))\n","        return F.softmax(self.fc3(hid), dim=-1)\n","\n","    # def forward(self, state):\n","    #     hid = torch.tanh(self.fc1(state))\n","    #     hid = torch.tanh(self.fc2(hid))\n","    #     hid = torch.tanh(self.fc3(hid))\n","    #     return F.softmax(self.fc4(hid), dim=-1)"],"execution_count":17,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"ynbqJrhIFTC3"},"source":["再來，搭建一個簡單的 agent，並搭配上方的 policy network 來採取行動。\n","這個 agent 能做到以下幾件事：\n","- `learn()`：從記下來的 log probabilities 及 rewards 來更新 policy network。\n","- `sample()`：從 environment 得到 observation 之後，利用 policy network 得出應該採取的行動。\n","而此函式除了回傳抽樣出來的 action，也會回傳此次抽樣的 log probabilities。"]},{"cell_type":"code","metadata":{"id":"zZo-IxJx286z","executionInfo":{"status":"ok","timestamp":1622943865992,"user_tz":-480,"elapsed":9,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}}},"source":["\n","class PolicyGradientAgent():\n","    \n","    def __init__(self, network):\n","        self.network = network\n","        # self.optimizer = optim.SGD(self.network.parameters(), lr=0.001)\n","        self.optimizer = optim.Adam(self.network.parameters(), lr=0.001)\n","         \n","    def forward(self, state):\n","        return self.network(state)\n","    def learn(self, log_probs, rewards):\n","        loss = (-log_probs * rewards).sum() # You don't need to revise this to pass simple baseline (but you can)\n","\n","        self.optimizer.zero_grad()\n","        loss.backward(retain_graph=True)\n","        self.optimizer.step()\n","        \n","    def sample(self, state):\n","        action_prob = self.network(torch.FloatTensor(state))\n","        action_dist = Categorical(action_prob)\n","        action = action_dist.sample()\n","        log_prob = action_dist.log_prob(action)\n","        return action.item(), log_prob\n","\n","    def save(self, PATH): # You should not revise this\n","        Agent_Dict = {\n","            \"network\" : self.network.state_dict(),\n","            \"optimizer\" : self.optimizer.state_dict()\n","        }\n","        torch.save(Agent_Dict, PATH)\n","\n","    def load(self, PATH): # You should not revise this\n","        checkpoint = torch.load(PATH)\n","        self.network.load_state_dict(checkpoint[\"network\"])\n","        #如果要儲存過程或是中斷訓練後想繼續可以用喔 ^_^\n","        self.optimizer.load_state_dict(checkpoint[\"optimizer\"])\n"],"execution_count":18,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"ehPlnTKyRZf9"},"source":["最後，建立一個 network 和 agent，就可以開始進行訓練了。"]},{"cell_type":"code","metadata":{"id":"GfJIvML-RYjL","executionInfo":{"status":"ok","timestamp":1622943865992,"user_tz":-480,"elapsed":9,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}}},"source":["network = PolicyGradientNetwork()\n","agent = PolicyGradientAgent(network)\n","#agent = PolicyGradientAgent()"],"execution_count":19,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"ouv23glgf5Qt"},"source":["## 訓練 Agent\n","\n","現在我們開始訓練 agent。\n","透過讓 agent 和 environment 互動，我們記住每一組對應的 log probabilities 及 reward，並在成功登陸或者不幸墜毀後，回放這些「記憶」來訓練 policy network。"]},{"cell_type":"code","metadata":{"id":"vg5rxBBaf38_","colab":{"base_uri":"https://localhost:8080/","height":66,"referenced_widgets":["05b1ee56970c410896877760b52c9214","8a3106d9a60142469f51c882ab6a089e","c1166743355440d2a355132a2fea512c","af1ee460ae414c2c8bc9132437e5c80e","497d775c41744cfaa78f9485ffe563f6","7c1338fd15274941a7d70c44c7c89d5f","ef822bf70c7e4f5992cb7e52985ca584","686c6cc13ece4aa3bd878184661dcb34"]},"executionInfo":{"status":"ok","timestamp":1622960580754,"user_tz":-480,"elapsed":16714770,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"d84eb405-1f18-44e5-ba1b-3e292b2ca6bc"},"source":["\"\"\"\n","# 現在的reward 的implementation 為每個時刻的瞬時reward, 給定action_list : a1, a2, a3 ......  reward :     r1, r2 ,r3 ......\n","# medium：將reward調整成accumulative decaying reward, 給定action_list : a1,a2, a3 ...... \n","# reward :     r1+0.99*r2+0.99^2*r3+......, r2+0.99*r3+0.99^2*r4+...... ,r3+0.99*r4+0.99^2*r5+ ......\n","# boss : implement DQN\n","# q_target = reward + 0.9 * q_next.max(1)[0].unsqueeze(1) # label\n","\"\"\"\n","from itertools import accumulate\n","def weighted(rewards):\n","    discount_rate = 0.99 #your discount rate\n","    # rewards = [0, 0, 10] # want to translate to: [9, 9.5, 10](approximation)\n","    reversed_rewards = rewards[::-1] #list reversal\n","    acc = list(accumulate(reversed_rewards, lambda x,y: x*discount_rate + y))\n","    return acc[::-1] \n","\"\"\"\"\"\"\n","\n","agent.network.train()  # 訓練前，先確保 network 處在 training 模式\n","# agent.load(f'model_{batch}.bin')\n","# EPISODE_PER_BATCH = 5  # 每蒐集 5 個 episodes 更新一次 agent\n","EPISODE_PER_BATCH = 20  # 每蒐集 20 個 episodes 更新一次 agent\n","\n","# NUM_BATCH = 400        # 總共更新 400 次\n","NUM_BATCH = 2000        # 總共更新 2000 次\n","avg_total_rewards, avg_final_rewards = [], []\n","\n","prg_bar = tqdm(range(NUM_BATCH))\n","for batch in prg_bar:\n","    if batch%100==0 and not batch==0:\n","      agent.save(f'model_{batch}.bin')\n","    log_probs, rewards = [], []\n","    total_rewards, final_rewards = [], []\n","\n","    # 蒐集訓練資料\n","    for episode in range(EPISODE_PER_BATCH):\n","        \n","        state = env.reset()\n","        total_reward, total_step = 0, 0\n","        seq_rewards = []\n","        while True:\n","            action, log_prob = agent.sample(state) # at , log(at|st)\n","            next_state, reward, done, _ = env.step(action)\n","\n","            log_probs.append(log_prob) # [log(a1|s1), log(a2|s2), ...., log(at|st)]\n","            seq_rewards.append(reward)\n","            state = next_state\n","            total_reward += reward\n","            total_step += 1\n","            # ! 重要 ！\n","            # 現在的reward 的implementation 為每個時刻的瞬時reward, 給定action_list : a1, a2, a3 ......  reward :     r1, r2 ,r3 ......\n","            # medium：將reward調整成accumulative decaying reward, 給定action_list : a1,a2, a3 ...... \n","            # reward :     r1+0.99*r2+0.99^2*r3+......, r2+0.99*r3+0.99^2*r4+...... ,r3+0.99*r4+0.99^2*r5+ ......\n","            # boss : implement DQN\n","            # rewards.append(reward) #改這裡\n","\n","            if done:\n","                seq_rewards = weighted(seq_rewards)\n","                seq_rewards = np.nan_to_num(seq_rewards).tolist()\n","                rewards.extend(seq_rewards)\n","                final_rewards.append(reward)\n","                total_rewards.append(total_reward)\n","                break\n","\n","\n","    # print(f\"rewards looks like \", np.shape(rewards))  \n","    # print(f\"log_probs looks like \", np.shape(log_probs))     \n","    # 紀錄訓練過程\n","    avg_total_reward = sum(total_rewards) / len(total_rewards)\n","    avg_final_reward = sum(final_rewards) / len(final_rewards)\n","    avg_total_rewards.append(avg_total_reward)\n","    avg_final_rewards.append(avg_final_reward)\n","    prg_bar.set_description(f\"Total: {avg_total_reward: 4.1f}, Final: {avg_final_reward: 4.1f}\")\n","\n","    # 更新網路\n","    # rewards = np.concatenate(rewards, axis=0)\n","    rewards = (rewards - np.mean(rewards)) / (np.std(rewards) + 1e-9)  # 將 reward 正規標準化\n","    agent.learn(torch.stack(log_probs), torch.from_numpy(rewards))\n","    # print(\"logs prob looks like \", torch.stack(log_probs).size())\n","    # print(\"torch.from_numpy(rewards) looks like \", torch.from_numpy(rewards).size())"],"execution_count":20,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"05b1ee56970c410896877760b52c9214","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=2000.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"vNb_tuFYhKVK"},"source":["### 訓練結果\n","\n","訓練過程中，我們持續記下了 `avg_total_reward`，這個數值代表的是：每次更新 policy network 前，我們讓 agent 玩數個回合（episodes），而這些回合的平均 total rewards 為何。\n","理論上，若是 agent 一直在進步，則所得到的 `avg_total_reward` 也會持續上升，直至 250 上下。\n","若將其畫出來則結果如下："]},{"cell_type":"code","metadata":{"id":"wZYOI8H10SHN","colab":{"base_uri":"https://localhost:8080/","height":281},"executionInfo":{"status":"ok","timestamp":1622960580755,"user_tz":-480,"elapsed":12,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"bd9d4963-4d6c-4a8d-96b1-8c4eb08f8e55"},"source":["end = time.time()\n","plt.plot(avg_total_rewards)\n","plt.title(\"Total Rewards\")\n","plt.show()"],"execution_count":21,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[],"needs_background":"light"}}]},{"cell_type":"markdown","metadata":{"id":"mV5jj4dThz0Y"},"source":["另外，`avg_final_reward` 代表的是多個回合的平均 final rewards，而 final reward 即是 agent 在單一回合中拿到的最後一個 reward。\n","如果同學們還記得環境給予登月小艇 reward 的方式，便會知道，不論**回合的最後**小艇是不幸墜毀、飛出畫面、或是靜止在地面上，都會受到額外地獎勵或處罰。\n","也因此，final reward 可被用來觀察 agent 的「著地」是否順利等資訊。"]},{"cell_type":"code","metadata":{"id":"txDZ5vlGWz5w","colab":{"base_uri":"https://localhost:8080/","height":281},"executionInfo":{"status":"ok","timestamp":1622960581367,"user_tz":-480,"elapsed":619,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"53e097c8-8d31-4b48-faf7-932c13b18f60"},"source":["plt.plot(avg_final_rewards)\n","plt.title(\"Final Rewards\")\n","plt.show()\n"],"execution_count":22,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[],"needs_background":"light"}}]},{"cell_type":"markdown","metadata":{"id":"gyT7tNwkVdS-"},"source":["訓練時間\n"]},{"cell_type":"code","metadata":{"id":"_t-JsKxUViFy","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1622960581368,"user_tz":-480,"elapsed":10,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"3b4229d8-dc15-4810-c820-a62ae6188074"},"source":["print(f\"total time is {end-start} sec\")"],"execution_count":23,"outputs":[{"output_type":"stream","text":["total time is 16726.134327173233 sec\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"u2HaGRVEYGQS"},"source":["## 測試"]},{"cell_type":"code","metadata":{"id":"5yFuUKKRYH73","colab":{"base_uri":"https://localhost:8080/","height":493},"executionInfo":{"status":"ok","timestamp":1622960582222,"user_tz":-480,"elapsed":860,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"e2ed476e-f745-4b8d-8f20-32f3e676e11e"},"source":["fix(env, seed)\n","agent.network.eval()  # 測試前先將 network 切換為 evaluation 模式\n","NUM_OF_TEST = 5 # Do not revise it !!!!!\n","test_total_reward = []\n","action_list = []\n","for i in range(NUM_OF_TEST):\n","  actions = []\n","  state = env.reset()\n","\n","  img = plt.imshow(env.render(mode='rgb_array'))\n","\n","  total_reward = 0\n","\n","  done = False\n","  while not done:\n","      action, _ = agent.sample(state)\n","      actions.append(action)\n","      state, reward, done, _ = env.step(action)\n","\n","      total_reward += reward\n","\n","      # img.set_data(env.render(mode='rgb_array'))\n","      # display.display(plt.gcf())\n","      # display.clear_output(wait=True)\n","  print(total_reward)\n","  test_total_reward.append(total_reward)\n","\n","  action_list.append(actions) #儲存你測試的結果\n","  print(\"length of actions is \", len(actions))"],"execution_count":24,"outputs":[{"output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/torch/__init__.py:422: UserWarning: torch.set_deterministic is deprecated and will be removed in a future release. Please use torch.use_deterministic_algorithms instead\n","  \"torch.set_deterministic is deprecated and will be removed in a future \"\n"],"name":"stderr"},{"output_type":"stream","text":["272.28243869649896\n","length of actions is  247\n","270.45646341293616\n","length of actions is  195\n","313.10081919059945\n","length of actions is  224\n","292.5353771491858\n","length of actions is  239\n","281.89026721362586\n","length of actions is  208\n"],"name":"stdout"},{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[],"needs_background":"light"}}]},{"cell_type":"code","metadata":{"id":"Aex7mcKr0J01","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1622960582223,"user_tz":-480,"elapsed":18,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"d3c854ac-45be-4d41-9621-6ebad473af12"},"source":["print(f\"Your final reward is : %.2f\"%np.mean(test_total_reward))"],"execution_count":25,"outputs":[{"output_type":"stream","text":["Your final reward is : 286.05\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"leyebGYRpqsF"},"source":["Action list 的長相"]},{"cell_type":"code","metadata":{"id":"hGAH4YWDpp4u","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1622960582223,"user_tz":-480,"elapsed":14,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"1d4fa357-6708-4803-f30c-827639597721"},"source":["print(\"Action list looks like \", action_list)\n","print(\"Action list's shape looks like \", np.shape(action_list))"],"execution_count":26,"outputs":[{"output_type":"stream","text":["Action list looks like  [[0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 3, 0, 1, 0, 3, 3, 2, 2, 1, 2, 2, 0, 3, 3, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 1, 2, 2, 2, 2, 2, 2, 2, 0, 1, 2, 3, 2, 3, 1, 2, 2, 2, 2, 2, 3, 3, 2, 2, 2, 3, 2, 1, 2, 2, 2, 2, 2, 0, 1, 3, 2, 2, 2, 2, 2, 2, 3, 2, 3, 2, 3, 2, 2, 2, 2, 2, 1, 3, 2, 2, 2, 1, 0, 2, 1, 2, 2, 2, 2, 1, 3, 2, 2, 2, 2, 2, 2, 0, 0, 2, 2, 2, 0, 1, 2, 2, 2, 0, 2, 1, 2, 2, 2, 2, 0, 3, 2, 3, 2, 2, 2, 2, 0, 1, 1, 2, 0, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 3, 3, 0, 0, 3, 3, 0, 0, 3, 3, 3, 2, 2, 1, 3, 1, 0, 2, 2, 2, 2, 0, 2, 2, 3, 2, 2, 2, 2, 2, 2, 0, 1, 2, 1, 2, 1, 1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 1, 3, 2, 2, 3, 2, 1, 2, 2, 2, 1, 2, 3, 2, 2, 2, 3, 2, 2, 2, 2, 2, 1, 3, 2, 2, 2, 2, 2, 2, 3, 2, 1, 1, 0, 2, 2, 2, 2, 3, 2, 2, 2, 3, 2, 2, 2, 2, 2, 0, 2, 2, 3, 3, 2, 1, 1, 3, 2, 2, 2, 2, 2, 2, 2, 2, 1, 0, 3, 2, 2, 3, 2, 2, 2, 3, 2, 2, 0, 2, 2, 3, 2, 2, 2, 1, 1, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [3, 3, 3, 3, 3, 3, 3, 3, 0, 3, 3, 2, 3, 2, 1, 2, 2, 3, 0, 2, 2, 3, 2, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 1, 1, 1, 2, 2, 1, 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, 3, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 3, 2, 2, 1, 1, 2, 1, 2, 0, 2, 2, 2, 1, 2, 0, 3, 2, 2, 3, 3, 2, 3, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 3, 2, 2, 2, 1, 3, 2, 2, 3, 3, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [3, 3, 3, 3, 3, 3, 3, 3, 2, 3, 3, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1, 1, 2, 2, 2, 2, 1, 1, 1, 2, 2, 2, 2, 2, 1, 2, 2, 1, 1, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 1, 1, 2, 1, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 0, 2, 3, 2, 3, 2, 3, 2, 2, 2, 2, 3, 2, 2, 2, 3, 3, 2, 2, 2, 2, 2, 2, 2, 3, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 1, 3, 2, 2, 2, 2, 2, 0, 0, 2, 2, 1, 2, 3, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 1, 2, 1, 1, 0, 2, 1, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 3, 3, 3, 3, 2, 1, 3, 3, 3, 3, 2, 2, 2, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [3, 3, 0, 0, 3, 3, 3, 1, 2, 2, 2, 3, 2, 2, 1, 1, 2, 3, 1, 2, 3, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 1, 2, 1, 2, 2, 2, 2, 2, 1, 1, 2, 2, 2, 1, 0, 2, 1, 2, 2, 3, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 0, 2, 2, 3, 2, 2, 1, 2, 3, 2, 2, 3, 2, 0, 3, 2, 0, 2, 2, 2, 2, 0, 2, 2, 2, 3, 2, 2, 2, 0, 1, 2, 2, 2, 1, 3, 2, 1, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 1, 1, 1, 2, 1, 2, 2, 3, 3, 3, 3, 1, 2, 2, 2, 2, 2, 0, 2, 1, 2, 1, 2, 2, 2, 3, 2, 2, 2, 2, 1, 2, 0, 1, 3, 2, 2, 3, 2, 2, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]\n","Action list's shape looks like  (5,)\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/numpy/core/_asarray.py:83: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray\n","  return array(a, dtype, copy=False, order=order)\n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"l7sokqEUtrFY"},"source":["Action 的分布\n"]},{"cell_type":"code","metadata":{"id":"WHdAItjj1nxw","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1622960582224,"user_tz":-480,"elapsed":12,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"d08ca0f3-dcc7-4f2f-a878-ad8ee94de094"},"source":["distribution = {}\n","for actions in action_list:\n","  for action in actions:\n","    if action not in distribution.keys():\n","      distribution[action] = 1\n","    else:\n","      distribution[action] += 1\n","print(distribution)"],"execution_count":27,"outputs":[{"output_type":"stream","text":["{0: 399, 1: 121, 3: 129, 2: 464}\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"ricE0schY75M"},"source":["儲存 Model Testing的結果\n"]},{"cell_type":"code","metadata":{"id":"GZsMkGmIY42b","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1622960582224,"user_tz":-480,"elapsed":10,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"ef9407b8-527c-4dfc-e5c6-08e9eb7627e0"},"source":["PATH = \"Action_List_test.npy\" # 可以改成你想取的名字或路徑\n","np.save(PATH ,np.array(action_list)) "],"execution_count":28,"outputs":[{"output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:2: VisibleDeprecationWarning: Creating an ndarray from ragged nested sequences (which is a list-or-tuple of lists-or-tuples-or ndarrays with different lengths or shapes) is deprecated. If you meant to do this, you must specify 'dtype=object' when creating the ndarray\n","  \n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"asK7WfbkaLjt"},"source":["### 你要交到JudgeBoi的檔案94這個\n","儲存結果到本地端 (就是你的電腦裡拉 = = )\n"]},{"cell_type":"code","metadata":{"id":"c-CqyhHzaWAL","colab":{"base_uri":"https://localhost:8080/","height":17},"executionInfo":{"status":"ok","timestamp":1622960582225,"user_tz":-480,"elapsed":8,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"07ac703e-e4f5-44c5-bf6f-4f1c3bf67dc5"},"source":["from google.colab import files\n","files.download(PATH)"],"execution_count":29,"outputs":[{"output_type":"display_data","data":{"application/javascript":["\n","    async function download(id, filename, size) {\n","      if (!google.colab.kernel.accessAllowed) {\n","        return;\n","      }\n","      const div = document.createElement('div');\n","      const label = document.createElement('label');\n","      label.textContent = `Downloading \"${filename}\": `;\n","      div.appendChild(label);\n","      const progress = document.createElement('progress');\n","      progress.max = size;\n","      div.appendChild(progress);\n","      document.body.appendChild(div);\n","\n","      const buffers = [];\n","      let downloaded = 0;\n","\n","      const channel = await google.colab.kernel.comms.open(id);\n","      // Send a message to notify the kernel that we're ready.\n","      channel.send({})\n","\n","      for await (const message of channel.messages) {\n","        // Send a message to notify the kernel that we're ready.\n","        channel.send({})\n","        if (message.buffers) {\n","          for (const buffer of message.buffers) {\n","            buffers.push(buffer);\n","            downloaded += buffer.byteLength;\n","            progress.value = downloaded;\n","          }\n","        }\n","      }\n","      const blob = new Blob(buffers, {type: 'application/binary'});\n","      const a = document.createElement('a');\n","      a.href = window.URL.createObjectURL(blob);\n","      a.download = filename;\n","      div.appendChild(a);\n","      a.click();\n","      div.remove();\n","    }\n","  "],"text/plain":["<IPython.core.display.Javascript object>"]},"metadata":{"tags":[]}},{"output_type":"display_data","data":{"application/javascript":["download(\"download_01874181-db29-40eb-8e5c-f6a51b2d2eb1\", \"Action_List_test.npy\", 2533)"],"text/plain":["<IPython.core.display.Javascript object>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"seT4NUmWmAZ1"},"source":["# Server 測試\n","到時候下面會是我們Server上測試的環境，可以給大家看一下自己的表現如何"]},{"cell_type":"code","metadata":{"id":"U69c-YTxaw6b"},"source":["action_list = np.load(PATH,allow_pickle=True) #到時候你上傳的檔案\n","seed = 543 #到時候測試的seed 請不要更改\n","fix(env, seed)\n","\n","agent.network.eval()  # 測試前先將 network 切換為 evaluation 模式\n","\n","test_total_reward = []\n","for actions in action_list:\n","  state = env.reset()\n","  img = plt.imshow(env.render(mode='rgb_array'))\n","\n","  total_reward = 0\n","\n","  done = False\n","  # while not done:\n","  done_count = 0\n","  for action in actions:\n","      # action, _ = agent1.sample(state)\n","      state, reward, done, _ = env.step(action)\n","      done_count += 1\n","      total_reward += reward\n","      if done:\n","        \n","        break\n","      img.set_data(env.render(mode='rgb_array'))\n","      display.display(plt.gcf())\n","      display.clear_output(wait=True)\n","  print(f\"Your reward is : %.2f\"%total_reward)\n","  test_total_reward.append(total_reward)"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"TjFBWwQP1hVe"},"source":["# 你的成績"]},{"cell_type":"code","metadata":{"id":"GpJpZz3Wbm0X","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1622960583275,"user_tz":-480,"elapsed":18,"user":{"displayName":"Huang Vincent","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ghpl69ExtckeK66-37ql1MDxCxxGOFRsSBWZDbjBQ=s64","userId":"16668226139279532247"}},"outputId":"25868602-ca3f-4235-eaf6-51c96dcbb451"},"source":["print(f\"Your final reward is : %.2f\"%np.mean(test_total_reward))"],"execution_count":31,"outputs":[{"output_type":"stream","text":["Your final reward is : 286.05\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"wUBtYXG2eaqf"},"source":["## 參考資料\n","\n","以下是一些有用的參考資料。\n","建議同學們實做前，可以先參考第一則連結的上課影片。\n","在影片的最後有提到兩個有用的 Tips，這對於本次作業的實做非常有幫助。\n","\n","- [DRL Lecture 1: Policy Gradient (Review)](https://youtu.be/z95ZYgPgXOY)\n","- [ML Lecture 23-3: Reinforcement Learning (including Q-learning) start at 30:00](https://youtu.be/2-JNBzCq77c?t=1800)\n","- [Lecture 7: Policy Gradient, David Silver](http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching_files/pg.pdf)\n"]},{"cell_type":"markdown","metadata":{"id":"cGqP2EU1joWM"},"source":[""]}]}